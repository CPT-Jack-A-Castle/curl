# perl:
#
#for(1 .. 200) {
#
#}
#
<testcase>
<info>
<keywords>
HTTP
cookies
</keywords>
</info>

#
# Server-side
<reply>
<data>
HTTP/1.1 200 OK
Date: Tue, 09 Nov 2010 14:49:00 GMT
Server: test-server/fake
Content-Length: 6
Set-Cookie: cookie-1=yes;
Set-Cookie: cookie-2=yes;
Set-Cookie: cookie-3=yes;
Set-Cookie: cookie-4=yes;
Set-Cookie: cookie-5=yes;
Set-Cookie: cookie-6=yes;
Set-Cookie: cookie-7=yes;
Set-Cookie: cookie-8=yes;
Set-Cookie: cookie-9=yes;
Set-Cookie: cookie-10=yes;
Set-Cookie: cookie-11=yes;
Set-Cookie: cookie-12=yes;
Set-Cookie: cookie-13=yes;
Set-Cookie: cookie-14=yes;
Set-Cookie: cookie-15=yes;
Set-Cookie: cookie-16=yes;
Set-Cookie: cookie-17=yes;
Set-Cookie: cookie-18=yes;
Set-Cookie: cookie-19=yes;
Set-Cookie: cookie-20=yes;
Set-Cookie: cookie-21=yes;
Set-Cookie: cookie-22=yes;
Set-Cookie: cookie-23=yes;
Set-Cookie: cookie-24=yes;
Set-Cookie: cookie-25=yes;
Set-Cookie: cookie-26=yes;
Set-Cookie: cookie-27=yes;
Set-Cookie: cookie-28=yes;
Set-Cookie: cookie-29=yes;
Set-Cookie: cookie-30=yes;
Set-Cookie: cookie-31=yes;
Set-Cookie: cookie-32=yes;
Set-Cookie: cookie-33=yes;
Set-Cookie: cookie-34=yes;
Set-Cookie: cookie-35=yes;
Set-Cookie: cookie-36=yes;
Set-Cookie: cookie-37=yes;
Set-Cookie: cookie-38=yes;
Set-Cookie: cookie-39=yes;
Set-Cookie: cookie-40=yes;
Set-Cookie: cookie-41=yes;
Set-Cookie: cookie-42=yes;
Set-Cookie: cookie-43=yes;
Set-Cookie: cookie-44=yes;
Set-Cookie: cookie-45=yes;
Set-Cookie: cookie-46=yes;
Set-Cookie: cookie-47=yes;
Set-Cookie: cookie-48=yes;
Set-Cookie: cookie-49=yes;
Set-Cookie: cookie-50=yes;
Set-Cookie: cookie-51=yes;
Set-Cookie: cookie-52=yes;
Set-Cookie: cookie-53=yes;
Set-Cookie: cookie-54=yes;
Set-Cookie: cookie-55=yes;
Set-Cookie: cookie-56=yes;
Set-Cookie: cookie-57=yes;
Set-Cookie: cookie-58=yes;
Set-Cookie: cookie-59=yes;
Set-Cookie: cookie-60=yes;
Set-Cookie: cookie-61=yes;
Set-Cookie: cookie-62=yes;
Set-Cookie: cookie-63=yes;
Set-Cookie: cookie-64=yes;
Set-Cookie: cookie-65=yes;
Set-Cookie: cookie-66=yes;
Set-Cookie: cookie-67=yes;
Set-Cookie: cookie-68=yes;
Set-Cookie: cookie-69=yes;
Set-Cookie: cookie-70=yes;
Set-Cookie: cookie-71=yes;
Set-Cookie: cookie-72=yes;
Set-Cookie: cookie-73=yes;
Set-Cookie: cookie-74=yes;
Set-Cookie: cookie-75=yes;
Set-Cookie: cookie-76=yes;
Set-Cookie: cookie-77=yes;
Set-Cookie: cookie-78=yes;
Set-Cookie: cookie-79=yes;
Set-Cookie: cookie-80=yes;
Set-Cookie: cookie-81=yes;
Set-Cookie: cookie-82=yes;
Set-Cookie: cookie-83=yes;
Set-Cookie: cookie-84=yes;
Set-Cookie: cookie-85=yes;
Set-Cookie: cookie-86=yes;
Set-Cookie: cookie-87=yes;
Set-Cookie: cookie-88=yes;
Set-Cookie: cookie-89=yes;
Set-Cookie: cookie-90=yes;
Set-Cookie: cookie-91=yes;
Set-Cookie: cookie-92=yes;
Set-Cookie: cookie-93=yes;
Set-Cookie: cookie-94=yes;
Set-Cookie: cookie-95=yes;
Set-Cookie: cookie-96=yes;
Set-Cookie: cookie-97=yes;
Set-Cookie: cookie-98=yes;
Set-Cookie: cookie-99=yes;
Set-Cookie: cookie-100=yes;
Set-Cookie: cookie-101=yes;
Set-Cookie: cookie-102=yes;
Set-Cookie: cookie-103=yes;
Set-Cookie: cookie-104=yes;
Set-Cookie: cookie-105=yes;
Set-Cookie: cookie-106=yes;
Set-Cookie: cookie-107=yes;
Set-Cookie: cookie-108=yes;
Set-Cookie: cookie-109=yes;
Set-Cookie: cookie-110=yes;
Set-Cookie: cookie-111=yes;
Set-Cookie: cookie-112=yes;
Set-Cookie: cookie-113=yes;
Set-Cookie: cookie-114=yes;
Set-Cookie: cookie-115=yes;
Set-Cookie: cookie-116=yes;
Set-Cookie: cookie-117=yes;
Set-Cookie: cookie-118=yes;
Set-Cookie: cookie-119=yes;
Set-Cookie: cookie-120=yes;
Set-Cookie: cookie-121=yes;
Set-Cookie: cookie-122=yes;
Set-Cookie: cookie-123=yes;
Set-Cookie: cookie-124=yes;
Set-Cookie: cookie-125=yes;
Set-Cookie: cookie-126=yes;
Set-Cookie: cookie-127=yes;
Set-Cookie: cookie-128=yes;
Set-Cookie: cookie-129=yes;
Set-Cookie: cookie-130=yes;
Set-Cookie: cookie-131=yes;
Set-Cookie: cookie-132=yes;
Set-Cookie: cookie-133=yes;
Set-Cookie: cookie-134=yes;
Set-Cookie: cookie-135=yes;
Set-Cookie: cookie-136=yes;
Set-Cookie: cookie-137=yes;
Set-Cookie: cookie-138=yes;
Set-Cookie: cookie-139=yes;
Set-Cookie: cookie-140=yes;
Set-Cookie: cookie-141=yes;
Set-Cookie: cookie-142=yes;
Set-Cookie: cookie-143=yes;
Set-Cookie: cookie-144=yes;
Set-Cookie: cookie-145=yes;
Set-Cookie: cookie-146=yes;
Set-Cookie: cookie-147=yes;
Set-Cookie: cookie-148=yes;
Set-Cookie: cookie-149=yes;
Set-Cookie: cookie-150=yes;
Set-Cookie: cookie-151=yes;
Set-Cookie: cookie-152=yes;
Set-Cookie: cookie-153=yes;
Set-Cookie: cookie-154=yes;
Set-Cookie: cookie-155=yes;
Set-Cookie: cookie-156=yes;
Set-Cookie: cookie-157=yes;
Set-Cookie: cookie-158=yes;
Set-Cookie: cookie-159=yes;
Set-Cookie: cookie-160=yes;
Set-Cookie: cookie-161=yes;
Set-Cookie: cookie-162=yes;
Set-Cookie: cookie-163=yes;
Set-Cookie: cookie-164=yes;
Set-Cookie: cookie-165=yes;
Set-Cookie: cookie-166=yes;
Set-Cookie: cookie-167=yes;
Set-Cookie: cookie-168=yes;
Set-Cookie: cookie-169=yes;
Set-Cookie: cookie-170=yes;
Set-Cookie: cookie-171=yes;
Set-Cookie: cookie-172=yes;
Set-Cookie: cookie-173=yes;
Set-Cookie: cookie-174=yes;
Set-Cookie: cookie-175=yes;
Set-Cookie: cookie-176=yes;
Set-Cookie: cookie-177=yes;
Set-Cookie: cookie-178=yes;
Set-Cookie: cookie-179=yes;
Set-Cookie: cookie-180=yes;
Set-Cookie: cookie-181=yes;
Set-Cookie: cookie-182=yes;
Set-Cookie: cookie-183=yes;
Set-Cookie: cookie-184=yes;
Set-Cookie: cookie-185=yes;
Set-Cookie: cookie-186=yes;
Set-Cookie: cookie-187=yes;
Set-Cookie: cookie-188=yes;
Set-Cookie: cookie-189=yes;
Set-Cookie: cookie-190=yes;
Set-Cookie: cookie-191=yes;
Set-Cookie: cookie-192=yes;
Set-Cookie: cookie-193=yes;
Set-Cookie: cookie-194=yes;
Set-Cookie: cookie-195=yes;
Set-Cookie: cookie-196=yes;
Set-Cookie: cookie-197=yes;
Set-Cookie: cookie-198=yes;
Set-Cookie: cookie-199=yes;
Set-Cookie: cookie-200=yes;

-foo-
</data>
</reply>

#
# Client-side
<client>
<server>
http
</server>
<name>
Many Set-Cookie response headers
</name>
<command>
http://attack.invalid:%HTTPPORT/a/b/%TESTNUMBER -c log/cookie%TESTNUMBER --resolve attack.invalid:%HTTPPORT:%HOSTIP
</command>
</client>

#
# Verify data after the test has been "shot"
<verify>
<protocol>
GET /a/b/%TESTNUMBER HTTP/1.1
Host: attack.invalid:%HTTPPORT
User-Agent: curl/%VERSION
Accept: */*

</protocol>
<file name="log/cookie%TESTNUMBER">
# Netscape HTTP Cookie File
# https://curl.se/docs/http-cookies.html
# This file was generated by libcurl! Edit at your own risk.

attack.invalid	FALSE	/a/b/	FALSE	0	cookie-50	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-49	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-48	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-47	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-46	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-45	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-44	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-43	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-42	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-41	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-40	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-39	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-38	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-37	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-36	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-35	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-34	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-33	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-32	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-31	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-30	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-29	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-28	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-27	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-26	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-25	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-24	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-23	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-22	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-21	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-20	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-19	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-18	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-17	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-16	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-15	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-14	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-13	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-12	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-11	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-10	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-9	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-8	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-7	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-6	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-5	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-4	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-3	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-2	yes
attack.invalid	FALSE	/a/b/	FALSE	0	cookie-1	yes
</file>
</verify>
</testcase>
